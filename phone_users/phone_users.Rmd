---
title: "PhoneUsers"
author: "Group D"
date: "2024-04-10"
output: html_document
---

```{r include=FALSE}
# Clear workspace, install library & import data
library("caret")
library("Metrics")
set.seed(1234)

rm(list = ls())
train <- read.csv("phone_train.csv", header=TRUE)
test <- read.csv("phone_validation.csv", header=TRUE)

train$sex <- as.factor(train$sex)
train$payment.method <- as.factor(train$payment.method)
train$activation.zone <- as.factor(train$activation.zone)
train$activation.channel <- as.factor(ifelse(train$activation.channel==5, 1, 0)) #Merge 
train$vas1 <- as.factor(train$vas1)
train$vas2 <- as.factor(train$vas2)

plot(train$sex)
plot(train$payment.method)
plot(train$activation.zone)
summary(train$activation.zone)

plot(train$activation.channel)

summary(train)

```


```{r}
fit <- lm(log(y+1) ~ . , data=train)
yhat <- exp(predict(fit, newdata=test) )-1
yhat=pmax(0,yhat)
summary(yhat)
write.table(file="mySubmission.txt", yhat,row.names = FALSE,col.names = FALSE)
```


##To binary
```{r}
library(dplyr)

to_binary_column_names = c("tariff.plan", "payment.method", "sex", "activation.zone", "activation.channel", "vas1", "vas2")

for (to_binary_colname in to_binary_column_names){
  new.column <- sapply(levels(factor(train[[to_binary_colname]])), function(level) {
    col_name <- paste(to_binary_colname, level, sep = "")
    (train[[to_binary_colname]] == level) * 1
  })
  colnames(new.column) <- paste(to_binary_colname, levels(factor(train[[to_binary_colname]])), sep = "")
  
  
  train <- cbind(train, new.column)
  
  train <- select(train, -to_binary_colname)
}
train
```
